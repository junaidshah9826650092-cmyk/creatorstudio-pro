<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beast Studio Editor | Professional Creator Tools</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="index.css?v=3.2">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- Google AdSense (Auto Ads & Final ID Sync) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6894674624448360"
        crossorigin="anonymous"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6894674624448360",
        });
    </script>
    <script src="index.js?v=4.2" defer></script>
    <style>
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid var(--primary);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            animation: slideIn 0.3s ease-out forwards;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- Navigation -->
        <nav>
            <div class="brand" onclick="window.location.href='/'" style="cursor:pointer">
                <div class="brand-icon">
                    <i data-lucide="zap" color="#fff" size="24"></i>
                </div>
                <span>BEAST<span style="color:var(--primary)">STUDIO</span></span>
            </div>

            <!-- Dynamic Command Center (Fills Empty Logo Area) -->
            <div class="command-center">
                <div class="cmd-btn" title="Undo (Ctrl+Z)" onclick="historyUndo()">
                    <i data-lucide="undo-2" size="18"></i>
                </div>
                <div class="cmd-separator"></div>
                <div class="cmd-info">
                    <span id="project-name">Untitled Design</span>
                    <span class="save-status">
                        <div class="status-dot"></div> Saved
                    </span>
                </div>
                <div class="cmd-separator"></div>
                <div class="cmd-btn" title="Grid View" onclick="toggleGrid()">
                    <i data-lucide="grid-3x3" size="18"></i>
                </div>
                <div class="cmd-separator"></div>
                <div class="cmd-btn" title="Save Project" onclick="saveDesign()" style="color:var(--primary)">
                    <i data-lucide="save" size="18"></i>
                </div>
            </div>

            <div class="auth-stack">
                <div id="auth-ui-container" style="display: flex; align-items: center; gap: 15px;">
                    <div id="credit-badge"
                        style="background: rgba(251, 191, 36, 0.1); border: 1px solid #fbbf24; padding: 4px 10px; border-radius: 8px; font-size: 12px; color: #fbbf24; font-weight: 700;">
                        <i data-lucide="coins" size="14" style="vertical-align: middle;"></i> <span
                            id="user-credits">0</span>
                    </div>
                    <div id="user-display" style="color: var(--text-secondary); font-size: 14px; font-weight: 600;">
                    </div>
                    <button class="btn-premium" onclick="openPricingModal()" id="upgrade-btn">UPGRADE</button>
                    <button class="btn-premium" style="background:transparent; border:1px solid var(--glass-border);"
                        onclick="handleLogout()">LOGOUT</button>
                </div>
            </div>
        </nav>

        <section class="workspace">
            <!-- CANVA-STYLE SIDEBAR SYSTEM -->
            <aside class="sidebar-container"
                style="display: flex; height: calc(100vh - 70px); background: var(--bg-card);">

                <!-- 1. ICON RAIL -->
                <div class="nav-rail"
                    style="width: 72px; background: #0f172a; display: flex; flex-direction: column; align-items: center; padding-top: 20px; gap: 20px; border-right: 1px solid var(--glass-border); z-index: 20; height: 100%;">
                    <div class="nav-item active" onclick="switchTab('design', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="background: rgba(255,255,255,0.05); padding: 8px; border-radius: 8px;"><i
                                data-lucide="layout-grid" size="20"></i></div>
                        <span>Design</span>
                    </div>
                    <div class="nav-item" onclick="switchTab('elements', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="padding: 8px;"><i data-lucide="shapes" size="20"></i></div>
                        <span>Elements</span>
                    </div>
                    <div class="nav-item" onclick="switchTab('text', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="padding: 8px;"><i data-lucide="type" size="20"></i></div>
                        <span>Text</span>
                    </div>
                    <div class="nav-item" onclick="switchTab('magic', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #fbbf24; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="padding: 8px;"><i data-lucide="sparkles" size="20"></i></div>
                        <span>Magic</span>
                    </div>
                    <div class="nav-item" onclick="switchTab('uploads', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="padding: 8px;"><i data-lucide="cloud-upload" size="20"></i></div>
                        <span>Uploads</span>
                    </div>
                    <div class="nav-item" onclick="switchTab('content', this)"
                        style="display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 10px; cursor: pointer; gap: 5px;">
                        <div style="padding: 8px;"><i data-lucide="file-text" size="20"></i></div>
                        <span>Content</span>
                    </div>
                </div>

                <!-- 2. EXPANDED PANEL CONTENT -->
                <div class="side-panel"
                    style="width: 320px; background: #1e293b; border-right: 1px solid var(--glass-border); display: flex; flex-direction: column; overflow-y: auto;">

                    <!-- TAB: DESIGN (Templates & Settings) -->
                    <div id="tab-design" class="panel-content active" style="padding: 20px;">
                        <h3 style="margin-bottom: 5px;">Templates</h3>
                        <p style="font-size: 11px; color: var(--text-secondary); margin-bottom: 20px;">Start fast with
                            pro layouts</p>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <!-- Template Card 1 -->
                            <div class="template-thumb" onclick="loadBeastTemplate('gaming_reaction')"
                                style="cursor:pointer; background: #0f172a; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05);">
                                <div
                                    style="height: 60px; background: linear-gradient(45deg, #ef4444, #f59e0b); display: flex; align-items: center; justify-content: center; color: white; font-weight: 900; font-size: 10px;">
                                    REACTION</div>
                                <div style="padding: 8px; font-size: 10px; font-weight: 600;">Epic Reaction</div>
                            </div>

                            <!-- Template Card 2 -->
                            <div class="template-thumb" onclick="loadBeastTemplate('clean_vlog')"
                                style="cursor:pointer; background: #0f172a; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05);">
                                <div
                                    style="height: 60px; background: linear-gradient(45deg, #3b82f6, #06b6d4); display: flex; align-items: center; justify-content: center; color: white; font-weight: 900; font-size: 10px;">
                                    VLOG</div>
                                <div style="padding: 8px; font-size: 10px; font-weight: 600;">Clean Minimal</div>
                            </div>

                            <!-- Template Card 3 (Premium Placeholder) -->
                            <div class="template-thumb"
                                style="opacity: 0.5; cursor: not-allowed; background: #0f172a; border-radius: 8px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05);">
                                <div
                                    style="height: 60px; background: #1e293b; display: flex; align-items: center; justify-content: center;">
                                    <i data-lucide="lock" size="14"></i>
                                </div>
                                <div style="padding: 8px; font-size: 10px;">Pro Layout</div>
                            </div>
                        </div>

                        <div style="margin-top: 25px;">
                            <button class="btn-premium" onclick="openAIModal()"
                                style="width: 100%; padding: 10px; font-size: 11px; gap: 5px;">
                                <i data-lucide="sparkles" size="14"></i> AI VARIANT GENERATOR
                            </button>
                        </div>

                        <h3 style="margin: 25px 0 15px 0;">Canvas Size</h3>
                        <div
                            style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 20px;">
                            <button onclick="setBeastPreset('16:9')" class="preset-chip"
                                style="padding: 10px; font-size: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; cursor: pointer;">
                                <i data-lucide="monitor" size="14"></i><br>16:9
                            </button>
                            <button onclick="setBeastPreset('1:1')" class="preset-chip"
                                style="padding: 10px; font-size: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; cursor: pointer;">
                                <i data-lucide="square" size="14"></i><br>1:1
                            </button>
                            <button onclick="setBeastPreset('9:16')" class="preset-chip"
                                style="padding: 10px; font-size: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: white; cursor: pointer;">
                                <i data-lucide="smartphone" size="14"></i><br>9:16
                            </button>
                        </div>

                        <h3 style="margin: 25px 0 15px 0;">Background</h3>
                        <div class="control-group">
                            <input type="color" id="bg-color" value="#6366f1"
                                style="width:100%; height:40px; border-radius:8px; border:none; margin-bottom:10px; cursor:pointer;">
                            <select id="gradient-type" class="input-box">
                                <option value="none">Solid Color</option>
                                <option value="linear">Vibrant Linear</option>
                                <option value="mesh">Mesh Gradient</option>
                            </select>
                        </div>
                    </div>

                    <!-- TAB: ELEMENTS (Shapes & Graphics) -->
                    <div id="tab-elements" class="panel-content" style="padding: 20px; display: none;">
                        <div class="search-box"
                            style="background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; display: flex; gap: 10px; margin-bottom: 20px;">
                            <i data-lucide="search" size="18" style="opacity: 0.5;"></i>
                            <input type="text" placeholder="Search shapes..."
                                style="background: transparent; border: none; color: white; outline: none; width: 100%;">
                        </div>

                        <h4>Shapes</h4>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px;">
                            <div class="shape-btn"
                                style="aspect-ratio: 1; background: #334155; border-radius: 4px; display:flex; align-items:center; justify-content:center; cursor:pointer;"
                                onclick="addShapeLayer('rect')">
                                <div style="width:20px; height:20px; background:white;"></div>
                            </div>
                            <div class="shape-btn"
                                style="aspect-ratio: 1; background: #334155; border-radius: 4px; display:flex; align-items:center; justify-content:center; cursor:pointer;"
                                onclick="addShapeLayer('circle')">
                                <div style="width:20px; height:20px; background:white; border-radius:50%;"></div>
                            </div>
                            <div class="shape-btn"
                                style="aspect-ratio: 1; background: #334155; border-radius: 4px; display:flex; align-items:center; justify-content:center; cursor:pointer;"
                                onclick="addShapeLayer('triangle')">
                                <div
                                    style="width:0; height:0; border-left:10px solid transparent; border-right:10px solid transparent; border-bottom:20px solid white;">
                                </div>
                            </div>
                            <div class="shape-btn" title="More shapes Pro only"
                                style="aspect-ratio: 1; background: #1e293b; border-radius: 4px; display:flex; align-items:center; justify-content:center; cursor:not-allowed; opacity: 0.3;">
                                <i data-lucide="lock" size="14"></i>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: TEXT (Typography) -->
                    <div id="tab-text" class="panel-content" style="padding: 20px; display: none;">
                        <button class="btn-premium" onclick="addTextLayer('Add a heading')"
                            style="width: 100%; margin-bottom: 10px; font-size: 1.5rem; font-weight: 800; text-align: left; padding: 15px;">Add
                            a heading</button>
                        <button class="btn-premium" onclick="addTextLayer('Add a subheading')"
                            style="width: 100%; margin-bottom: 10px; font-size: 1.1rem; font-weight: 600; text-align: left; padding: 12px; background: rgba(255,255,255,0.1);">Add
                            a subheading</button>
                        <button class="btn-premium" onclick="addTextLayer('Add body text')"
                            style="width: 100%; margin-bottom: 25px; font-size: 0.9rem; text-align: left; padding: 10px; background: rgba(255,255,255,0.05);">Add
                            a little bit of body text</button>

                        <div style="border-top: 1px solid var(--glass-border); padding-top: 20px;">
                            <span class="section-label">Quick Styles</span>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div class="template-thumb"
                                    onclick="addTextLayer('NEON', canvas.width/2, canvas.height/2)"
                                    style="cursor:pointer; background: #000; border-radius: 8px; padding: 10px; color: #00f3ff; text-align: center; font-weight: 800; border: 1px solid #00f3ff; text-shadow: 0 0 5px #00f3ff;">
                                    NEON</div>
                                <div class="template-thumb"
                                    onclick="addTextLayer('RETRO', canvas.width/2, canvas.height/2)"
                                    style="cursor:pointer; background: #ff00ff; border-radius: 8px; padding: 10px; color: white; text-align: center; font-weight: 800; border: 1px solid white;">
                                    RETRO</div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: MAGIC (AI Tools) -->
                    <div id="tab-magic" class="panel-content" style="padding: 20px; display: none;">
                        <h3 style="color: #fbbf24; margin-bottom: 15px; display: flex; align-items: center; gap: 8px;">
                            <i data-lucide="sparkles"></i> Magic Tools
                        </h3>

                        <div class="magic-card" onclick="openMagicMedia()"
                            style="background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%); padding: 15px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; transition: transform 0.2s;">
                            <div style="display:flex; justify-content:space-between;"><strong>Magic Media</strong> <i
                                    data-lucide="image"></i></div>
                            <p style="font-size:0.8rem; opacity:0.8;">Text to Image Generation</p>
                        </div>

                        <div class="magic-card" onclick="triggerMagicWrite()"
                            style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); padding: 15px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; transition: transform 0.2s;">
                            <div style="display:flex; justify-content:space-between;"><strong>Magic Write</strong> <i
                                    data-lucide="pen-tool"></i></div>
                            <p style="font-size:0.8rem; opacity:0.8;">AI Copywriter & Rewrite</p>
                        </div>

                        <div class="magic-card" onclick="triggerMagicSwitch()"
                            style="background: linear-gradient(135deg, #db2777 0%, #e11d48 100%); padding: 15px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; transition: transform 0.2s;">
                            <div style="display:flex; justify-content:space-between;"><strong>Magic Switch</strong> <i
                                    data-lucide="arrow-left-right"></i></div>
                            <p style="font-size:0.8rem; opacity:0.8;">Instant Resize & Reformat</p>
                        </div>

                        <div class="magic-card" onclick="triggerMagicMorph()"
                            style="background: linear-gradient(135deg, #d97706 0%, #fbbf24 100%); padding: 15px; border-radius: 12px; margin-bottom: 15px; cursor: pointer; transition: transform 0.2s;">
                            <div style="display:flex; justify-content:space-between;"><strong>Magic Morph</strong> <i
                                    data-lucide="wand-2"></i></div>
                            <p style="font-size:0.8rem; opacity:0.8;">Text Effects & Texture</p>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                            <button class="btn-premium" onclick="triggerMagicEraser()"
                                style="font-size: 0.75rem; padding: 10px; background: rgba(255,255,255,0.05);">
                                <i data-lucide="eraser"></i> Magic Eraser
                            </button>
                            <button class="btn-premium" onclick="triggerMagicExpand()"
                                style="font-size: 0.75rem; padding: 10px; background: rgba(255,255,255,0.05);">
                                <i data-lucide="expand"></i> Magic Expand
                            </button>
                        </div>
                    </div>

                    <!-- TAB: UPLOADS -->
                    <div id="tab-uploads" class="panel-content" style="padding: 20px; display: none;">
                        <input type="file" id="upload-input" accept="image/*" style="display: none;"
                            onchange="handleFileUpload(this)">
                        <button class="btn-premium" onclick="document.getElementById('upload-input').click()"
                            style="width: 100%; margin-bottom: 20px;">
                            <i data-lucide="cloud-upload"></i> Upload Media
                        </button>

                        <div id="uploads-gallery" style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <!-- Uploaded images appear here -->
                        </div>
                        <p
                            style="text-align: center; color: var(--text-secondary); font-size: 0.8rem; margin-top: 20px;">
                            Supported: JPG, PNG, WEBP</p>
                    </div>

                    <!-- TAB: AI CONTENT STUDIO (NEW) -->
                    <div id="tab-content" class="panel-content" style="padding: 20px; display: none;">
                        <h3 style="margin-bottom: 5px;">AI Studio</h3>
                        <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 20px;">Gemini-powered
                            creator tools</p>

                        <div class="control-group" style="margin-bottom: 20px;">
                            <label
                                style="font-size: 11px; color: var(--text-secondary); margin-bottom: 5px; display: block;">Select
                                Tool</label>
                            <select id="ai-tool-type" class="input-box"
                                style="width: 100%; padding: 10px; background: #0f172a; border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px;">
                                <option value="viral_pack">üî• Viral Content Pack (All-in-One)</option>
                                <option value="style_analyzer">üß† CTR Style Analyzer</option>
                                <option value="title">üé¨ Viral YouTube Titles</option>
                                <option value="script">üé• Reel/Short Script</option>
                                <option value="hook">ü™ù Scroll-Stopping Hooks</option>
                                <option value="thumbnail">üñºÔ∏è Thumbnail Text Ideas</option>
                                <option value="hashtag">#Ô∏è‚É£ Hashtag Generator</option>
                            </select>
                        </div>

                        <div class="control-group" style="margin-bottom: 20px;">
                            <label
                                style="font-size: 11px; color: var(--text-secondary); margin-bottom: 5px; display: block;">What
                                is your video about?</label>
                            <textarea id="ai-topic" placeholder="e.g. My morning routine as a software engineer..."
                                style="width: 100%; height: 80px; padding: 10px; background: #0f172a; border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 8px; resize: none; font-size: 13px;"></textarea>
                        </div>

                        <button onclick="generateAIStudioContent()" id="ai-gen-btn" class="btn-premium"
                            style="width: 100%; height: 50px; font-weight: 700; font-size: 14px; margin-bottom: 20px;">
                            <i data-lucide="sparkles" size="18"></i> GENERATE (5 Credits)
                        </button>

                        <!-- RESULTS AREA -->
                        <div id="ai-results-container" style="display: none; flex-direction: column; gap: 15px;">
                            <hr style="border: 0.5px solid rgba(255,255,255,0.1); margin-bottom: 15px;">
                            <div id="ai-output-list" style="display: flex; flex-direction: column; gap: 10px;">
                                <!-- Cards injected here -->
                            </div>
                        </div>

                        <!-- LOADING STATE -->
                        <div id="ai-loading" style="display: none; text-align: center; padding: 40px 0;">
                            <div class="loading-spinner"
                                style="border: 4px solid rgba(255,255,255,0.1); border-top: 4px solid var(--primary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 15px;">
                            </div>
                            <p style="font-size: 13px; color: var(--text-secondary);">Gemini is thinking...</p>
                        </div>

                        <!-- SURVEY REWARD CARD -->
                        <div id="survey-card"
                            style="margin-top: 30px; background: linear-gradient(135deg, rgba(99,102,241,0.1), rgba(167,139,250,0.1)); border: 1px dashed var(--primary); border-radius: 12px; padding: 15px;">
                            <div style="display: flex; gap: 10px; align-items: flex-start;">
                                <i data-lucide="gift" color="var(--primary)" size="20"></i>
                                <div style="flex: 1;">
                                    <h5 style="margin: 0 0 5px 0; font-size: 13px; color: #fff;">Get 50 FREE Credits! üéÅ
                                    </h5>
                                    <p
                                        style="font-size: 11px; color: var(--text-secondary); line-height: 1.4; margin-bottom: 10px;">
                                        Help us build the next big feature & earn credits.</p>
                                    <input type="text" id="survey-input" placeholder="What should we build next?"
                                        style="width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px; padding: 8px; font-size: 11px; color: white; margin-bottom: 10px; box-sizing: border-box;">
                                    <button onclick="submitFounderSurvey()"
                                        style="width: 100%; background: var(--primary); color: white; border: none; border-radius: 6px; padding: 8px; font-size: 11px; font-weight: 700; cursor: pointer; transition: opacity 0.2s;">CLAIM
                                        REWARD</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </aside>

            <main class="viewport"
                style="flex: 1; min-width: 0; background: #0f172a; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative;">
                <div class="canvas-wrapper animate-ready">
                    <canvas id="beast-canvas"></canvas>
                </div>

                <!-- TOOLBAR (Floating) -->
                <div class="toolbar" style="position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);">
                    <div class="tool-item" onclick="openAIModal()">
                        <i data-lucide="sparkles" style="color:var(--secondary)"></i>
                        <span>AI Studio</span>
                    </div>
                    <div class="tool-item" onclick="addTextLayer()">
                        <i data-lucide="type"></i>
                        <span>Text</span>
                    </div>
                    <div class="tool-item" onclick="document.getElementById('upload-input').click()">
                        <i data-lucide="image"></i>
                        <span>Image</span>
                    </div>
                    <div class="tool-item" onclick="toggleGrid()">
                        <i data-lucide="grid-3x3"></i>
                        <span>Grid</span>
                    </div>
                </div>
            </main>

            <!-- 3. RIGHT PANEL: LAYERS & PROPERTIES -->
            <aside id="right-panel"
                style="width: 260px; background: #1e293b; border-left: 1px solid var(--glass-border); display: flex; flex-direction: column;">
                <div style="padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05);">
                    <h3 style="font-size: 14px; display: flex; align-items: center; gap: 8px;">
                        <i data-lucide="layers" size="16"></i> Layers
                    </h3>
                </div>

                <div id="layer-list"
                    style="flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; gap: 8px;">
                    <!-- Layers injected here by index.js -->
                    <div style="text-align: center; color: #64748b; font-size: 12px; margin-top: 40px;">No layers yet.
                    </div>
                </div>

                <div id="properties-panel"
                    style="padding: 20px; background: rgba(0,0,0,0.2); border-top: 1px solid rgba(255,255,255,0.05); display: none;">
                    <h4 style="font-size: 11px; color: var(--primary); text-transform: uppercase; margin-bottom: 15px;">
                        Properties</h4>

                    <div id="text-input-group" style="margin-bottom: 15px;">
                        <label style="font-size: 10px; opacity: 0.6; display: block; margin-bottom: 5px;">Text
                            Content</label>
                        <input type="text" id="prop-text" oninput="updateObject('text', this.value)" class="input-box"
                            style="width: 100%; font-size: 12px; padding: 10px;">
                    </div>

                    <div class="control-group" style="margin-bottom: 15px;">
                        <label
                            style="font-size: 10px; opacity: 0.6; display: block; margin-bottom: 5px;">Opacity</label>
                        <input type="range" id="prop-opacity" min="0" max="1" step="0.1"
                            oninput="updateObject('opacity', this.value)" style="width: 100%;">
                    </div>

                    <div id="text-props">
                        <label style="font-size: 10px; opacity: 0.6; display: block; margin-bottom: 5px;">Font
                            Size</label>
                        <input type="number" id="prop-size" oninput="updateObject('fontSize', this.value)"
                            class="input-box" style="width: 100%; margin-bottom: 10px; font-size: 12px; padding: 10px;">

                        <label style="font-size: 10px; opacity: 0.6; display: block; margin-bottom: 5px;">Color</label>
                        <input type="color" id="prop-color" oninput="updateObject('color', this.value)"
                            style="width: 100%; height: 35px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.1); background: #0f172a; cursor: pointer;">
                    </div>

                    <div style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 15px;">
                        <span style="font-size: 10px; opacity: 0.6; display: block; margin-bottom: 10px;">Layer
                            Actions</span>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
                            <button onclick="duplicateLayer()" class="btn-premium"
                                style="padding: 8px; font-size: 11px; background: rgba(255,255,255,0.05);"><i
                                    data-lucide="copy" size="14"></i> Copy</button>
                            <button onclick="deleteLayer()" class="btn-premium"
                                style="padding: 8px; font-size: 11px; background: rgba(239, 68, 68, 0.1); color: #ef4444;"><i
                                    data-lucide="trash-2" size="14"></i> Delete</button>
                            <button onclick="moveLayer('up')" class="btn-premium"
                                style="grid-column: span 2; padding: 8px; font-size: 11px; background: rgba(255,255,255,0.05);"><i
                                    data-lucide="arrow-up-circle" size="14"></i> Bring to Forward</button>
                            <button onclick="moveLayer('down')" class="btn-premium"
                                style="grid-column: span 2; padding: 8px; font-size: 11px; background: rgba(255,255,255,0.05);"><i
                                    data-lucide="arrow-down-circle" size="14"></i> Send to Backward</button>
                        </div>
                    </div>
                </div>
            </aside>
        </section>

        <!-- Pricing Modal -->
        <div id="pricing-modal"
            style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:4000; align-items:center; justify-content:center; backdrop-filter:blur(15px);">
            <div
                style="background:var(--bg-card); width:95%; max-width:800px; padding:2rem; border-radius:30px; border:1px solid var(--glass-border); text-align:center;">
                <h2 style="font-size: 2rem; margin-bottom: 0.5rem;">Choose Your <span
                        style="color:var(--primary)">BEAST</span> Power</h2>
                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 2rem;">
                    <div
                        style="background: var(--glass); padding: 2rem; border-radius: 20px; border: 1px solid var(--glass-border);">
                        <h3>FREE</h3>
                        <div style="font-size: 2rem; margin: 1rem 0;">$0</div>
                        <button class="btn-premium" style="background: grey; width: 100%;" disabled>CURRENT</button>
                    </div>
                    <div
                        style="background: rgba(99, 102, 241, 0.1); padding: 2rem; border-radius: 20px; border: 2px solid var(--primary); transform: scale(1.05);">
                        <h3 style="color:var(--primary)">PRO</h3>
                        <div style="font-size: 2rem; margin: 1rem 0;">$19</div>
                        <button class="btn-premium" style="width: 100%;" onclick="buyPlan('PRO')">UPGRADE PRO</button>
                    </div>
                    <div
                        style="background: rgba(236, 72, 153, 0.1); padding: 2rem; border-radius: 20px; border: 1px solid var(--secondary);">
                        <h3 style="color:var(--secondary)">BEAST</h3>
                        <div style="font-size: 2rem; margin: 1rem 0;">$49</div>
                        <button class="btn-premium" style="background: var(--secondary); width: 100%;"
                            onclick="buyPlan('BEAST')">GO BEAST</button>
                    </div>
                </div>
                <button onclick="closePricingModal()"
                    style="margin-top: 2rem; background: transparent; border: none; color: white; cursor: pointer; opacity: 0.6;">Close
                    for now</button>
            </div>
        </div>

        <!-- AI Assistant Modal -->
        <div id="ai-modal"
            style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:3000; align-items:center; justify-content:center; backdrop-filter:blur(10px);">
            <div
                style="background:var(--bg-card); width:90%; max-width:500px; padding:2rem; border-radius:24px; border:1px solid var(--glass-border);">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:2rem;">
                    <h2 style="display:flex; align-items:center; gap:10px;"><i data-lucide="brain-circuit"
                            color="var(--secondary)"></i> AI Assistant</h2>
                    <i data-lucide="x" style="cursor:pointer; opacity:0.6;" onclick="closeAIModal()"></i>
                </div>
                <div class="control-group">
                    <span class="section-label">AI Configuration</span>
                    <select id="ai-provider" class="input-box">
                        <option value="openrouter">OpenRouter (Pro)</option>
                    </select>
                    <input type="password" id="ai-api-key" class="input-box" placeholder="Your API Secret Key"
                        style="margin: 10px 0;">
                    <select id="ai-model" class="input-box">
                        <option value="google/gemini-2.0-flash-exp:free">Gemini 2.0 Flash</option>
                    </select>
                    <span class="section-label" style="margin-top:1rem;">What should BEAST create?</span>
                    <textarea id="ai-prompt" class="input-box" style="height:80px; resize:none; margin-top:5px;"
                        placeholder="Describe your brand..."></textarea>
                    <button class="btn-premium" style="width:100%; height:50px; margin-top:1rem;"
                        onclick="generateWithAI()">
                        <i data-lucide="wand-2" style="margin-right:8px;"></i> <span id="ai-btn-text">INITIALIZE
                            GENERATION</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating WhatsApp Group Support -->
    <a href="https://chat.whatsapp.com/H3u6PNzZqqpIGCYURSGoV0" target="_blank" title="Join Debug & Tasks Group"
        style="position: fixed; bottom: 30px; right: 30px; z-index: 5000; background: #25D366; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 20px rgba(0,0,0,0.3); transition: transform 0.3s; text-decoration: none;">
        <svg width="35" height="35" viewBox="0 0 24 24" fill="white" stroke="none">
            <path
                d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
        </svg>
    </a>

    <div id="toast-container" class="toast-container"></div>
    <script>
        // Global error catcher for user debugging
        window.onerror = function (msg, url, line) {
            const container = document.getElementById('toast-container');
            if (container) {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.style.border = '1px solid #ef4444';
                toast.textContent = "Error: " + msg.split('\n')[0];
                container.appendChild(toast);
                setTimeout(() => toast.remove(), 5000);
            }
            return false;
        };
        // Initializer
        window.onload = () => {
            if (typeof checkAuth === 'function') checkAuth();
            if (typeof initBeast === 'function') initBeast();
        };
    </script>
</body>

</html>